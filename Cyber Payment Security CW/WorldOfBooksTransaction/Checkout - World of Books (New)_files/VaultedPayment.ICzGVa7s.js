import{bU as L,bS as _,bT as T,w as I,n as z,ap as A,bV as R,bW as f,a as s,z as U,bY as $,h as q,g as F,ei as K,hC as j,H as V,A as C,b7 as G,aJ as k,b9 as H,T as J,q0 as N,q1 as O,hD as W,ba as X,bb as Y,B,q2 as Q,cd as Z,bx as ee,g4 as ne,ch as te,cf as oe,q3 as ae}from"./app.eeJKwMD1.js";function se(){const e=L(),n=_(),t=T(),o=I(),i=z(),l=o("review.blocks.change_link_label","Change"),{inMemoryAmazonPayParts:{hasPaymentSheetError:d}}=A();return!R()||n.status!==f.Available?null:s(U,{onPress:()=>{try{n.sdk.buywithprime.changePaymentMethod({amazonPayOptions:{amazonCheckoutSessionId:t(),isDeclined:e}})}catch(c){d.value=!0,i.notify(new $(`Error on changing buyer payment method. Details: ${c}`,{cause:c}))}},children:l})}class r extends Error{name="PortableWalletsSandboxError"}function re({wallet:e,isSdkOnly:n=!1}){const{id:t}=q(),o=z(),i=F(),{value:l}=K(),{countryCode:d,presentmentCurrency:h}=l??{},c=j(e)?.configurationParams,[x,P]=V(!1),{inMemoryAmazonPayParts:{buttonStatus:b,sdkStatus:m}}=A(),p=C(null),g=C(null),S=G(),y=k(({errorMessage:a})=>o.notify(new r(a)),[o]),M=k(async a=>{m.value={status:f.Loading};const u=await a.call.configure({configurationParams:c,buyerCountry:d,buyerCurrency:h,shopId:t,cartId:i.sourceId,onlySdk:n});u?.status==="success"?(m.value=ie(e,a),n||(b.value={status:"rendered"})):u?.status==="error"&&(y({errorMessage:u?.message}),m.value={status:f.Error},n||(b.value={status:"error"}))},[c,d,t,h,i.sourceId,n,e,y,m,b]),w=H(),E=J(()=>({clicked:a=>{P(!0),S(g),a&&ce(a.skus,a.apiClientId)},closed:()=>P(!1),redirect:({redirectUrl:a,requestPayload:u})=>{try{if(u){if(!p.current){o.notify(new N("Form container not found"));return}O({formContainer:p.current,url:a,requestPayload:u}).submit()}else window.location.assign(a)}catch(D){o.notify(D)}},reportError:y,telemetry:w}),[P,y,o,S,w]);return c?!d||!h?(o.notify(new W(`[PortableWalletsButton] Attempted to render wallet button for ${e}, but no countryCode or presentmentCurrency was found.`)),null):s(B,{children:[s("div",{ref:p,style:{display:"none"}}),s(X,{wallet:e,onConnect:M,hostMethods:E,isSdkOnly:n,ref:g}),s(Y,{isOpen:x})]}):(o.notify(new W(`[PortableWalletsButton] Attempted to render wallet button for ${e}, but no config was found.`)),null)}function ie(e,n){return{status:f.Available,sdk:{buywithprime:{changePaymentMethod:({amazonPayOptions:t})=>{if(!t.amazonCheckoutSessionId)throw new r("Missing amazonCheckoutSessionId");n.call.changePaymentMethod({wallet:e,changePaymentParams:{amazonCheckoutSessionId:t.amazonCheckoutSessionId,isDeclined:t.isDeclined}})},changeShippingAddress:({amazonPayOptions:t})=>{if(!t.amazonCheckoutSessionId)throw new r("Missing amazonCheckoutSessionId");n.call.changeShippingAddress({wallet:e,changeShippingParams:{amazonCheckoutSessionId:t.amazonCheckoutSessionId}})},initCheckout:()=>{throw new r('Unexpected invocation of "initCheckout"')},renderButton:()=>{throw new r('Unexpected invocation of "renderButton"')}},Pay:{changePaymentMethod:()=>{throw new r('Unexpected invocation of AmazonPay "changePaymentMethod" in BWP flow')},changeShippingAddress:()=>{throw new r('Unexpected invocation of AmazonPay "changeShippingAddress" in BWP flow')},initCheckout:()=>{throw new r('Unexpected invocation of AmazonPay "initCheckout" in BWP flow')},renderButton:()=>{throw new r('Unexpected invocation of AmazonPay "renderButton" in BWP flow')}}}}}function ce(e,n){window.Shopify?.analytics?.publish&&(window.Shopify.analytics.publish(`shopify:app:pixels:load:${n}`,{},{sendTo:"PIXEL-LOADER"}),window.Shopify.analytics.publish("bwp_checkout_widget_click",{skus:e},{sendTo:n}))}function ue(){const e=I(),{brand:n,descriptor:t}=Q(),o=Z(),i=ee(),l=!t||!o;return s(B,{children:[i?s(re,{wallet:ne.BuyWithPrime,isSdkOnly:!0}):null,s(te,{id:"buyWithPrimePayDetails",label:e("payment.payment_method","Payment method"),summary:l?s(oe,{}):s(ae,{brand:n,descriptor:t}),action:s(se,{})})]})}const de=Object.freeze(Object.defineProperty({__proto__:null,default:ue},Symbol.toStringTag,{value:"Module"}));export{re as P,de as V};
