import{i0 as Ve,j as he,d3 as ve,k as Re,h as _e,g as Z,d8 as Fe,T as F,da as ue,db as R,i1 as Be,hy as Oe,aN as Ce,H as A,aJ as w,o as we,a as _,i2 as He,A as I,b_ as $e,i3 as We,K as g,Y as ye,i4 as ze,B as Ie,c0 as Ge,dj as qe,i5 as Ke,ap as Me,i6 as Le,i7 as be,i8 as j,i9 as Ae,dt as fe,ia as Q,ib as H,ic as Ne,id as W,ie as ae,ig as pe,bs as X,ih as je,ii as ie,ij as Te,ik as Ye,il as Je,im as D,io as ke,n as Qe,ip as Xe,fs as Ze,w as et,eH as tt,iq as nt,ir as ot,is as De,it as st,iu as rt,iv as at,aj as it,iw as Ee}from"./app.eeJKwMD1.js";import{p as $,S as B,A as K,u as ct,M as xe,a as ut}from"./useSubscribeMessenger.9e0j9VkX.js";import{u as dt,a as lt,i as ft,b as J,c as me,d as Ue,e as Se,f as ht,A as pt,g as mt,r as St,R as yt,h as ge,j as kt,k as Et}from"./index.CtqHxpP0.js";const gt=e=>{const{alternate:n}=Ce(),t=Ve(),o=he(),{iframe_token:s,redirect_url:l,transaction_params:c}=ve(),r=Re(),{myshopifyDomain:u}=_e(),{checkoutSessionIdentifier:a}=Z(),i=Fe();return F(()=>{if(!a)throw new ue("ShopPayCheckoutIdentifierMissingError::ULCFrame");if(!i||!(s&&l))return;const S=e===R.C1InlineModal?{[Be]:Oe.ShopPayAsPaymentMethod}:null,f={shopify_domain:u,checkout_token:a,origin:e,locale:r,iframe_token:s,redirect_url:l,transaction_params:c,shop_pay_new_signup_login_variant:i,...S};o?.email&&(f.fast_login=!0);const d=Object.entries(f).map(h=>`${encodeURIComponent(h[0])}=${encodeURIComponent(h[1]||"")}`);t&&d.push(t);const m=d.join("&");return`https://${n}/pay/transactions/new/email?${m}`},[e,n,u,a,r,s,l,c,i,t,o])},Pt=10;function vt({x:e,y:n}){const t=window.devicePixelRatio||1;return{x:Math.round(e*t)/t||0,y:Math.round(n*t)/t||0}}function _t(e,n,t,o,{offset:s=0,arrowOffset:l=0}={}){let c={x:0,y:0},r={left:0,right:0},u=0;if(!n&&!t)return{offsets:c,spacing:u};if(!o){const{clientWidth:a,clientHeight:i}=document.documentElement;return c={x:a/2-n/2,y:i/2-t/2},{offsets:c,spacing:u}}switch(e){case"blockEnd":c={x:(document?.dir??"ltr")==="rtl"?o.left:o.right-n,y:o.bottom+s};break;case"inlineEnd":c={x:(document?.dir??"ltr")==="rtl"?o.left-n-s:o.right+s,y:o.top+o.height/2-l};break}return r=Ct(c,n),r.right&&!r.left?(c.x+=r.right,u=-10):!r.right&&r.left&&(c.x=0,u=Pt),{offsets:c,spacing:u}}function Ct(e,n){const t=document.documentElement.clientWidth,o=e.x+n;let s={left:0,right:0};return o>t&&(s={...s,right:t-o}),e.x<0&&(s={...s,left:-e.x}),s}function wt(){const[e,n]=A(null),t=w(o=>{o!==null&&n(o.getBoundingClientRect())},[]);return[e,t]}function It(e){const[n,t]=A(null),o=w(()=>{e!==null&&t(e.getBoundingClientRect())},[e]);return we(()=>(o(),window.addEventListener("resize",o),window.addEventListener("scroll",o),()=>{window.removeEventListener("resize",o),window.removeEventListener("scroll",o)}),[o]),n}const Mt="qdHCv",Lt={Popper:Mt};function bt({children:e,offset:n,arrowOffset:t,contentWidth:o,contentHeight:s,placement:l="inlineEnd",activator:c,open:r}){const u=It(c??null),[a,i]=wt(),{offsets:p,spacing:S}=F(()=>r?_t(l,(o||a?.width)??0,(s||a?.height)??0,u,{offset:n,arrowOffset:t}):{offsets:{x:0,y:0},spacing:0},[n,t,l,a,u,r,o,s]),{x:f,y:d}=F(()=>r?vt({x:p.x+S+(window.scrollX||window.pageXOffset),y:p.y+(window.scrollY||window.pageYOffset)}):{x:0,y:0},[p,S,r]),m=F(()=>r?(window.devicePixelRatio||1)<2?`translate(${f}px, ${d}px)`:`translate3d(${f}px, ${d}px, 0)`:"none",[r,f,d]);return _(He,{children:_("div",{className:Lt.Popper,style:{...a&&{transform:m,MozTransform:m,WebkitTransform:m}},ref:i,"aria-hidden":!r,children:e})})}const At="hgqpU",Nt="axmya",Tt="JHj7j",Dt="hQvGd",xt="PMbsk",Ut="wA8HY",Vt="xnzQ4",V={Backdrop:At,"Backdrop-visible":"LTbS5",BackdropLinearGradient:Nt,Popover:Tt,Content:Dt,PopoverArrow:xt,PopoverOpen:Ut,"Popover-placementInlineEnd":"trTaz","Popover-placementBlockEnd":"KMvI7",Bumper:Vt},Rt=Ge("Popover");function Ft({children:e,activator:n,open:t,placement:o="inlineEnd",contentWidth:s,contentHeight:l,onClose:c}){const r=I(null),u=I(null),a=I(null),i=$e(void 0,Rt),p=We(),S=w(()=>{n?.tagName==="BUTTON"&&(n?.setAttribute("aria-controls",i),n?.setAttribute("aria-expanded",String(t)))},[n,t,i]),f=w(k=>{c?.(k)},[c]),d=w(k=>{k.target instanceof Node&&!n?.contains(k.target)&&document.contains(k.target)&&!a.current?.contains(k.target)&&t&&f(k)},[f,n,t,a]),m=w(k=>{if(t)switch(k.key){case"Escape":case"Esc":f(),n?.focus();break}},[f,n,t]);g(()=>(document.addEventListener("click",d),()=>{document.removeEventListener("click",d)}),[d]),g(()=>(t&&document.addEventListener("keydown",m,!1),()=>{document.removeEventListener("keydown",m,!1)}),[t,m]),g(()=>{S()}),we(()=>{t&&a.current?.focus({preventScroll:!0})},[t]);const h=k=>{const v=a.current;if(v){const M=k?qe(v):Ke(v);M?M.focus():v.focus()}},P=ye(V.Popover,V[ze("Popover-placement",o)],t&&V.PopoverOpen,n&&V.PopoverArrow);return _(Ie,{children:[_(bt,{activator:n,placement:o,offset:15,arrowOffset:30,open:t,contentWidth:s,contentHeight:l,children:[t&&_("button",{className:V.Bumper,ref:r,"aria-hidden":"true",onFocus:()=>h(!1)}),_("div",{className:P,id:i,ref:a,children:_("div",{className:V.Content,children:e})}),t&&_("button",{className:V.Bumper,ref:u,"aria-hidden":"true",onFocus:()=>h(!0)})]}),_("div",{className:ye(V.Backdrop,t&&V["Backdrop-visible"],t&&p&&V.BackdropLinearGradient)})]})}const Bt="B1y2m",Ot={VerificationIframe:Bt};var ce=(e=>(e.Normal="normal",e.CustomerAccount="customer_account",e.AccountsSameStore="accounts_same_store",e.AccountsCrossStore="accounts_cross_store",e))(ce||{});function Ht({email:e,skipVerifyOnLoad:n,iframeReady:t,iframeRef:o,dismissedModalKey:s,readyToDismiss:l,onReadyToDismiss:c,showPopover:r,showToggle:u,popoverActivator:a}){const i=he(),{inMemoryPayPalParts:{accountStatus:p}}=Me(),{guestDismissedModalKey:S}=Le(),{checkoutSessionIdentifier:f}=Z(),d=be(j.ShopPayVerification,{scope:Ne}),m=Ae().current.token;g(()=>{if(n.current&&t){n.current=!1;return}const v=i&&fe(s),M=e&&Q(e),x=p.value.status==="connected",N=i&&$t();if(!(!t||!M||v||x||N)){if(d.peek()===H.Verified){d.value=void 0;return}$(o?.current,{action:B.Create,email:e,flow:ce.Normal,disableAutoFocus:!!sessionStorage.getItem(S)})}},[e,t]);function h(){if(!f)throw new ue("ShopPayCheckoutIdentifierMissingError::GuestCheckout");i&&fe(s)||e&&Q(e)&&(l||c(),m&&$(o?.current,{action:B.CheckoutQueueToken,queueToken:m}),W(ie,escape(f)),ae(j.IdentifiedShopPayUser,escape(f)),W(Te,"false"),window.dispatchEvent(new Event("shop_pay_user_identified_cookie_set")),d.value=H.Pending,sessionStorage.getItem(S)?u?.(!0):(r(!0,e),u?.(!1)))}function P(){l&&(d.value=H.Dismissed,i&&W(s,"true"),a?.current?.focus(),r(!1),u?.(!0))}function k(){pe(),d.value=H.Verified,X.value="none"}return{onShow:h,onHidden:P,onLoggedIn:k}}function $t(){const e=sessionStorage.getItem(je);if(!e)return!1;const n=Number.parseInt(e,10);return isNaN(n)?!1:Date.now()<n}const Wt=[K.FraudGuard,K.InvalidPhone,K.LimitExceeded,K.PhoneBlocked];function zt({email:e,onSetEmail:n,skipVerifyOnLoad:t,iframeReady:o,iframeRef:s,readyToDismiss:l,onReadyToDismiss:c,showPopover:r,popoverActivator:u,origin:a,open:i}){const{checkoutSessionIdentifier:p}=Z(),{openModal:S}=Ye(),{exchangeSessionTokenForCookie:f}=ct(),d=I(null),m=I(!1),h=Je(),P=w(()=>{s.current&&$(s.current,{action:B.Create,email:"",flow:ce.Normal})},[s]);g(()=>{s.current&&o&&a===R.C1ModalShopPaySignIn&&($(s.current,{action:B.AllowNoInitialEmail}),P(),$(s.current,{action:B.Ready}))},[o,s,a,P]),g(()=>{i&&(d.current=null)},[i]),g(()=>{m.current&&s.current&&o&&(m.current=!1,P())}),g(()=>{function y(){n&&(h.set({email:"",userStatus:D.None}),n(""),u?.current?.focus()),m.current=!0}return window.addEventListener("shop_pay_verification_reset",y),()=>{window.removeEventListener("shop_pay_verification_reset",y)}},[u,r,n,s,h]),g(()=>{if(!o)return;if(t.current){t.current=!1;return}e&&Q(e)&&a!==R.C1ModalShopPaySignIn?(h.set({email:e,userStatus:D.Loading}),$(s?.current,{action:B.Create,email:e,flow:ce.Normal})):a!==R.C1ModalShopPaySignIn&&(P(),h.set({email:"",userStatus:D.None}))},[e,o,t,s,a,h,P,r]);function k(){if(!p)throw new ue("ShopPayCheckoutIdentifierMissingError::ShopPayCheckout");a===R.C1ModalShopPay&&e&&Q(e)&&(l||c(),h.set({email:e,userStatus:D.Found}),r(!0,e))}function v(){if(a===R.C1ModalShopPay&&!l)return;const y=d.current;n!=null&&y!=null&&(y.userStatus!==D.Found||a===R.C1ModalShopPay||!e)&&(n(y.email),h.set(y),u?.current?.focus()),h.get().userStatus===D.Found?S({type:ke.ContinueWithShopPay,email:h.get().email}):u?.current?.focus(),r(!1),d.current=null}function M(y,L,T){if(!(T&&T!==h.get().email)&&(y===xe.ShopifyPayUserNotFound&&Wt.includes(L)&&(r(!1),S({type:ke.Generic})),T)){const O=L===K.InvalidEmail;h.set({email:T,userStatus:O?D.Invalid:D.New})}}function x(y,L){y?(d.current||h.get().email!==y)&&(d.current={email:y,userStatus:L?D.Found:D.New}):d.current={email:"",userStatus:D.None}}async function N(y,L){pe(),X.value="none",y&&(await f({token:y,origin:a,in_checkout_profile_preview:L}),window.location.reload())}return{onShow:k,onHidden:v,onEmailChange:x,onError:M,onLoggedIn:N}}function Gt(e){const n=Qe(),t=I(e),o=t.current,s=e===t.current?void 0:`Callback hook changed from ${t.current.name} to ${e.name} between renders.`;return g(()=>{s&&n.notify(new Xe(`${s} Only the original hook is called.`,"ShopPayError::OnlyOriginalHookCalled"),{severity:"warning",errorClass:"ShopPay::ShopPayVerification::useStableHook"})},[s,n]),o}const qt="shop-pay-verification-iframe",Pe=320,Kt=300,jt=1e3;function Yt({email:e,onSetEmail:n,open:t,popoverActivator:o,showPopover:s,showToggle:l,urlOrigin:c=R.C1Modal,updatedOrigin:r=c,onIframeLoaded:u}){const a=Ze({base:"blockEnd",medium:"inlineEnd"}),[i,p]=A(!1),[S,f]=A(Kt),[d,m]=A(!1),h=et(),{checkoutSessionIdentifier:P}=Z(),k=I(null),{alternate:v}=Ce(),M=v,[x,N]=A(!1),y=tt.flow.value===nt.UnauthenticatedUser,L=ot(e,rt),T=`${P}-${e.replace(/[^a-zA-Z0-9]/g,"")}`,O=De(),Y=I(O),{onShow:E,onHidden:C,onError:z,onEmailChange:ee,onLoggedIn:G}=Gt(y?zt:Ht)({email:L,onSetEmail:n,skipVerifyOnLoad:Y,iframeReady:i,iframeRef:k,dismissedModalKey:T,readyToDismiss:d,onReadyToDismiss:()=>{setTimeout(()=>m(!0),jt)},showPopover:s,showToggle:l,popoverActivator:o,origin:r,open:t});ut({hostname:M,targetId:c,onReady:E,onClosed:de,onLoggedIn:G,onHidden:C,onError:le,onResized:ne,onLoaded:()=>{p(!0),u()},onEmailChange:ee}),g(()=>{$(k?.current,{action:B.OriginChanged,origin:r})},[r]),g(()=>{const U=t?B.Ready:B.Hidden;$(k?.current,{action:U}),X.value=t?"shopPayVerification":"none",k.current&&t&&k.current.focus()},[t]);const b=gt(c);if(g(()=>()=>{p(!1)},[b]),!b)return null;const te=t?o?.current:void 0;return _(Ft,{activator:te,open:t,onClose:C,placement:a,contentWidth:Pe,contentHeight:S,children:_(st,{active:x||!i,size:"large",children:_("iframe",{id:qt,title:h("shop_pay.verification.title","Shop Pay Quick Checkout"),ref:k,src:b,height:S,width:Pe,className:Ot.VerificationIframe,allow:"publickey-credentials-get *",referrerPolicy:"origin"},b)})});function ne(U){!isNaN(U)&&U&&f(U)}function de(){N(!0)}function le(U,oe,se){z?.(U,oe,se),U===xe.ShopifyPayUserNotFound&&(W(ie,"false"),ae(j.IdentifiedShopPayUser,"false")),W(Te,oe===K.LimitExceeded?P||"":"false"),window.dispatchEvent(new Event("shop_pay_user_identified_cookie_set"))}}function Jt(e){const{element:n}=dt(),{loading:t}=lt();g(()=>{if(!(!n||t!==!1))return Object.entries(e).forEach(([o,s])=>{n.addEventListener(o,s)}),n?._eventListenerReadyPromiseResolve(),()=>{Object.entries(e).forEach(([o,s])=>{n?.removeEventListener(o,s)})}},[n,t,e])}function Qt(){if(!ft())return;const e="shop-pay-safari-unzoom",n=J.getElementById(e);if(n)return n.focus();const t=J.createElement("input");t.id=e,t.style.fontSize="16px",t.style.width="1px",t.style.height="1px",t.style.position="fixed",t.style.bottom="-1000px",t.style.right="-1000px",t.style.transform="translate(1000px, 1000px)",t.setAttribute("aria-hidden","true"),J.body.appendChild(t),t.focus({preventScroll:!0})}const Xt=100;function Zt({emailInputSelector:e}){const[n,t]=A(),[o,s]=A();return g(()=>{function c(r){this.type==="password"?s(r.timeStamp):t(r.timeStamp)}if(e){const r=J.querySelector(e);if(r){r.addEventListener("input",c);const u=r.form?.querySelector('input[type="password"]');return u&&u instanceof HTMLInputElement&&u.addEventListener("input",c),()=>{r.removeEventListener("input",c),u&&u.removeEventListener("input",c)}}}},[e]),{isFilledWithPasswordManager:F(()=>n===void 0||o===void 0?!1:Math.abs(n-o)<Xt,[n,o])}}function en({autoOpen:e,email:n,emailInputSelector:t,hideChange:o,iframeRef:s,shouldListen:l=!0}){const{autoOpened:c,loaded:r,modalVisible:u,sessionDetected:a}=me(),{leaveBreadcrumb:i,notify:p}=Ue(),{trackUserAction:S}=Se(),{isFilledWithPasswordManager:f}=Zt({emailInputSelector:t}),d=I(null),[m,h]=A(),[P,k]=A(),[v,M]=A(),x=I(null),N=I(""),y=F(()=>new Set,[]),L=()=>N.current,T=w(async(E,C="",z="")=>{const ee=ht(E);if(f&&!y.has("PASSWORD_MANAGER_AUTOFILL_DETECTED")&&(y.add("PASSWORD_MANAGER_AUTOFILL_DETECTED"),S({userAction:"PASSWORD_MANAGER_AUTOFILL_DETECTED"})),ee&&!y.has("EMAIL_ENTERED")&&(y.add("EMAIL_ENTERED"),S({userAction:"EMAIL_ENTERED"})),i("email entered",{},"state"),!s.current||u||r&&a&&e&&!c)return;const G=ee?E:"";d.current&&!d.current?.signal.aborted&&d.current.abort(),d.current=new AbortController;try{const{open:b,postMessage:te,waitForMessage:ne}=s.current;N.current=G,te({firstName:C,lastName:z,type:"namesubmitted"}),te({email:G,hideChange:o===void 0?G.length>0:o,type:"emailsubmitted"}),i("email submitted",{email:G?"redacted":""},"state");const de=ne("shop_user_matched",d.current.signal),le=new Promise((U,oe)=>{const se=async()=>{try{const re=await ne("error",d.current.signal);re.type==="error"&&re.code==="captcha_challenge"?U(void 0):se()}catch(re){oe(re)}};se()});await Promise.race([de,le]),b("event_shop_user_matched"),x?.current?.blur(),Qt(),d.current.abort(),h(void 0)}catch(b){if(b instanceof pt&&b.name==="AbortSignalReceivedError")return;b instanceof Error&&p(new Error(`Error updating user info: ${b.name} - ${b.message}`))}},[e,c,o,s,f,i,r,u,p,a,S,y]),O=mt((E,C,z)=>{T(E,C,z)},200);g(()=>{m!==void 0&&r&&O(m,P,v)},[O,m,r,P,v]),g(()=>{if(!t)return;const E=J.querySelector(t);if(!E)return;x.current=E;const C=()=>{E&&h(E.value)};if(E?.value&&C(),!l){E?.removeEventListener("input",C);return}return E?.addEventListener("input",C),()=>{E?.removeEventListener("input",C)}},[t,l]),g(()=>{n!==void 0&&h(n)},[n]);const Y=(E="",C="")=>{k(E),M(C)};return{getSubmittedEmail:L,updateEmailToPost:E=>h(E||""),updateNamesToPost:(E,C)=>Y(E,C)}}function tn({iframeRef:e}){const{loaded:n}=me();async function t(o){if(!e.current)return;const{postMessage:s,waitForMessage:l}=e.current;n||await l("loaded"),s(o)}return{postMessageAfterLoad:t}}function nn(){const{analyticsData:e,produceMonorailEvent:n}=Se();return{trackShopPayModalStateChange:w(({currentState:o,zoom:s})=>{const{analyticsTraceId:l,checkoutToken:c,checkoutVersion:r,shopPermanentDomain:u}=e,a={previousState:"",currentState:o,clientTimestampMs:new Date().getTime(),analyticsTraceId:l,checkoutToken:c||"",checkoutVersion:r||"",shopifyDomain:u||"",zoom:s};n({event:{payload:a,schemaId:"shopify_pay_modal_state_change/1.3"}})},[e,n])}}function on(e){const{checkoutToken:n,checkoutVersion:t,shopPermanentDomain:o}=e;return{checkoutVersion:t,checkoutToken:n,flow:"checkout_modal",shopPermanentDomain:o}}const sn=({anchorTo:e,email:n,queueToken:t,...o})=>{const{modalVisible:s}=me(),l=I(null);en({email:n,iframeRef:l});const{postMessageAfterLoad:c}=tn({iframeRef:l}),{trackUserAction:r}=Se(),{leaveBreadcrumb:u}=Ue(),a=F(()=>({open:async()=>{s||(l.current?.open("user_button_clicked"),r({userAction:"OPEN_CALLED"}),u("open called",{},"state"))}}),[s,r,u]);Jt(a);const{trackShopPayModalStateChange:i}=nn(),p=w(()=>{i({currentState:"loaded",zoom:`${ge.visualViewport?.scale}`})},[i]),S=w(d=>{i({currentState:d?"shown":"hidden",zoom:`${ge.visualViewport?.scale}`})},[i]);g(()=>{t&&c({type:"checkoutqueuetokensubmitted",checkoutQueueToken:t})},[c,t]);const{authorizeUrl:f}=kt({analyticsContext:"loginWithShopCheckoutModal",avoidSdkSession:!0,clientId:"",disableSignUp:!0,proxy:!0,redirectType:"iframe",responseType:"code",...o});return _(Et,{anchorTo:e,keepModalOpen:!0,onLoaded:p,onModalVisibleChange:S,proxy:!0,ref:l,src:f,variant:"checkoutModal"})},rn=()=>St(({element:e,...n})=>_(yt,{element:e,monorailProps:on(n),featureName:"ShopCheckoutModal",children:_(sn,{...n})}),{methods:["open"],name:"shop-checkout-modal",props:{anchorTo:"string",checkoutRedirectUrl:"string",checkoutToken:"string",checkoutVersion:"string",email:"string",queueToken:"string",shopPermanentDomain:"string",transactionParams:"string"},shadow:"open"}),q=({shopCheckoutModal:e,eventName:n,eventListener:t})=>{g(()=>(e?.addEventListener(n,t),()=>e?.removeEventListener(n,t)),[t,n,e])};function an({email:e,open:n,popoverActivator:t,showPopover:o,showToggle:s,onIframeLoaded:l}){const c=t?.current,r=I(null),[u,a]=A(!1),i=I(!1),{redirect_url:p,transaction_params:S}=ve(),{myshopifyDomain:f}=_e(),d=he(),{inMemoryPayPalParts:{accountStatus:m}}=Me(),{guestDismissedModalKey:h}=Le(),{checkoutSessionIdentifier:P}=Z(),k=Ae().current.token;g(()=>{customElements.get("shop-checkout-modal")||rn()},[]);const v=be(j.ShopPayVerification,{scope:Ne}),M=`${P}-${e.replace(/[^a-zA-Z0-9]/g,"")}`,x=De(),N=I(x);g(()=>{if(N.current){N.current=!1,a(!1);return}const E=sessionStorage.getItem(h),C=d&&fe(M),z=m.peek().status==="connected";if(E||C||z){a(!1);return}if(v.peek()===H.Verified){v.value=void 0,a(!1);return}a(!0)},[e]);const y=w(()=>{pe(),v.value=H.Verified,X.value="none"},[v]);q({shopCheckoutModal:r.current,eventName:"completed",eventListener:y});const L=w(()=>{if(!P)throw new ue("ShopPayCheckoutIdentifierMissingError::ShopJSVerification");W(ie,escape(P)),ae(j.IdentifiedShopPayUser,escape(P)),window.dispatchEvent(new Event("shop_pay_user_identified_cookie_set")),v.value=H.Pending,o?.(!0,e),s?.(!1)},[P,e,v,o,s]);q({shopCheckoutModal:r.current,eventName:"modalopened",eventListener:L});const T=w(()=>{v.value=H.Dismissed,d&&W(M,"true"),o?.(!1),s?.(i.current)},[d,M,v,o,s]);q({shopCheckoutModal:r.current,eventName:"modalclosed",eventListener:T});const O=w(()=>{i.current=!0},[]);q({shopCheckoutModal:r.current,eventName:"shopusermatched",eventListener:O});const Y=w(E=>{i.current=!1,W(ie,"false"),ae(j.IdentifiedShopPayUser,"false"),window.dispatchEvent(new Event("shop_pay_user_identified_cookie_set"))},[]);return q({shopCheckoutModal:r.current,eventName:"shopusernotmatched",eventListener:Y}),q({shopCheckoutModal:r.current,eventName:"loaded",eventListener:l}),g(()=>{const E=r.current;X.value=n?"shopPayVerification":"none",c&&n&&(E?.open(),c.blur())},[c,e,n]),p?_("shop-checkout-modal",{"anchor-to":c?.id?`#${c.id}`:"","checkout-redirect-url":p,"checkout-token":P,"checkout-version":"checkout_one",email:n||u?e:"","queue-token":k||"",ref:r,"shop-permanent-domain":f,"transaction-params":S}):null}const cn=e=>_(Ie,{children:_(an,{...e})}),fn=({email:e,onSetEmail:n,open:t,popoverActivator:o,showPopover:s,showToggle:l,urlOrigin:c=R.C1Modal,updatedOrigin:r=R.C1Modal})=>{const u=at(),a=it(),i=F(()=>Ee(),[]),p=F(()=>Ee(),[]),S=I(!0),f=F(()=>{if(u!==void 0)return{isC1:!0,shopJsVerification:!u}},[u]);g(()=>{Q(e)&&(i.mark("start"),S.current=!0)},[i,e]),g(()=>{if(t&&S.current&&i.marks.start&&f){i.mark("open"),S.current=!1;const m=Math.round(i.marks.open-i.marks.start);a.histogram({name:"shop_pay_verification_time_to_interactive",value:m,attributes:f});const h=Math.round(i.marks.open-Math.max(i.marks.start,i.marks.loaded||0));a.histogram({name:"shop_pay_verification_time_to_interactive_after_load",value:h,attributes:f})}},[t,a,i,f]),g(()=>{p.mark("start")},[p]);const d=w(()=>{if(p.marks.start){p.mark("loaded"),i.mark("loaded");const m=Math.round(p.marks.loaded-p.marks.start);a.histogram({name:"shop_pay_verification_iframe_ready_duration",value:m,attributes:f})}},[p,i,a,f]);return u?_(Yt,{popoverActivator:o,email:e,onSetEmail:n,open:t,showPopover:s,showToggle:l,urlOrigin:c,updatedOrigin:r,onIframeLoaded:d}):_(cn,{popoverActivator:o,email:e,open:t,showPopover:s,showToggle:l,onIframeLoaded:d})};export{fn as default};
